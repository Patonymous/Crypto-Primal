\section{Pseudokod algorytmu}

Poniższy pseudokod prezentuje procedurę ataku Primal z wykorzystaniem algorytmu redukcji bazy BKZ (Block Korkine-Zolotarev).

\begin{algorithm}[H]
\caption{Atak Primal na LWE (Wariant z zanurzeniem)}
\begin{algorithmic}[1]
\Require Macierz publiczna $\mathbf{A} \in \mathbb{Z}_q^{m \times n}$, wektor $\mathbf{b} \in \mathbb{Z}_q^m$, moduł $q$, rozmiar bloku BKZ $\beta$.
\Ensure Odszyfrowany sekret $\mathbf{s}'$ lub $\bot$ (w przypadku niepowodzenia).

\State \textbf{Krok 1: Konstrukcja macierzy bazowej $\mathbf{B}$}
\State Zainicjalizuj macierz $\mathbf{B}$ o wymiarach $(m+n+1) \times (m+n+1)$ wartościami zerowymi.
\State Wstaw blok $q\mathbf{I}_m$ w lewym górnym rogu.
\State Wstaw transponowaną macierz $\mathbf{A}^T$ w wierszach od $m$ do $m+n-1$, w kolumnach $0..m-1$.
\State Wstaw macierz jednostkową $\mathbf{I}_n$ w wierszach od $m$ do $m+n-1$, w kolumnach $m..m+n-1$.
\State Wstaw transponowany wektor $\mathbf{b}^T$ w ostatnim wierszu, w kolumnach $0..m-1$.
\State Ustaw element $\mathbf{B}[m+n, m+n] \gets 1$.

\State \textbf{Krok 2: Redukcja kraty}
\State $\mathbf{B}_{red} \gets \text{LLL}(\mathbf{B})$ \Comment{Wstępna redukcja algorytmem LLL}
\State $\mathbf{B}_{red} \gets \text{BKZ}(\mathbf{B}_{red}, \text{block\_size}=\beta)$ \Comment{Silna redukcja algorytmem BKZ}

\State \textbf{Krok 3: Ekstrakcja kandydata}
\For{każdy wiersz $\mathbf{v}$ w macierzy $\mathbf{B}_{red}$}
    \State $f \gets \mathbf{v}[m+n]$ \Comment{Pobranie współczynnika homologicznego}
    \State $\mathbf{s}_{cand} \gets \mathbf{v}[m : m+n] \div f \pmod q$ \Comment{Pobranie fragmentu odpowiadającego sekretowi}
    \If{$\mathbf{A}\mathbf{s}_{cand} \approx \mathbf{b} \pmod q$} \Comment{Weryfikacja poprawności rozwiązania}
        \State \Return $\mathbf{s}_{cand}$
    \EndIf
    \State $\mathbf{s}_{cand} \gets -\mathbf{s}_{cand}$ \Comment{Sprawdź również wektor przeciwny (SVP wyznacza wektor z dokładnością do znaku)}
    \If{$\mathbf{A}\mathbf{s}_{cand} \approx \mathbf{b} \pmod q$}
        \State \Return $\mathbf{s}_{cand}$
    \EndIf
\EndFor

\State \Return $\bot$
\end{algorithmic}
\end{algorithm}
